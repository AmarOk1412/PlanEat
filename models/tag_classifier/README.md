# Usage

This model is used to classify recipes into tags. This is how to build/update it:

## Environment

tflite-model-maker is not working great with recent version of Python, so we use Python 3.9 here.

### Initialize environment

```
python3.9 -m venv .venv3.9
. .venv3.9/bin/activate
```

### Install dependencies

```
pip install tflite-model-maker==0.4.3
pip install scikit-learn
```

### Generate dataset

First, you will need to generate input.csv

This model can be generated by un-comment `gigaDataset` in `PlanEatApp.kt`

This will scrap a lot of recipes from several websites to generate a file called `input.csv` in app's data

## Generate model

The resulting model is a tflite model embedded in the application.

This allow the app to work offline.

### Generate dataset

The first thing to do is to generate `train.csv` and `test.csv`.
Those two files are csv files with header: "Ingredient, Category"

To do the current model, you can call:

```bash
python split.py
```

This will generate the two csv files.

### Train model

Then the next step is to train the model.

The TagClassifier can be trained by calling:

```bash
# Took several hours on a CPU
python classifier.py
# Then Move the model to the app
mv model_multi_label.tflite app/src/main/assets/
mv labels.txt app/src/main/assets/
mv tokenizer.json app/src/main/assets/
```

It will be used by `TagClassifier.kt`

### Test model

You can use `predict.py` to test manually the model